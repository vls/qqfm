<html>
	<head>
		<meta charset="gb2312">
		<link rel="stylesheet" href="http://imgcache.qq.com/mediastyle/musicradio/default.css">
		<style type="text/css">
		body {
			width: 400px;
			margin: 0;
			height: 43px;
			background-color: #000000;
		}
		/*
		.song_opt {
			position: static;
		}
		.song_opt b {
			position: static;
		}
		*/
		#songInfo {
			float: right;
			margin-top: 12px;
			margin-right: 10px;
			
		}
		#player {
			height : 80px;
		}
		</style>
	</head>
	<body>
	
		<div id="player" style="overflow:hidden;">
			<!--
			<div class="title" id="player_title" style="left: 0px; top: -74px; ">
				<h3 id="divfmtitle">华语</h3>
				<p><a href="javascript:;" name="script_btn" id="share_fm" title="分享电台">分享电台</a> <a href="javascript:;" name="script_btn" title="收藏电台">收藏电台</a></p>
				<b></b>
			</div>
			
			<div class="song_cover" id="divsongcover">
				<img id="img2" onerror="this.src='http://imgcache.qq.com/mediastyle/musicradio/img/cover.jpg';this.onerror=null;" src="http://ctc.imgcache.qq.com/music/photo/album/63/albumpic_70363_0.jpg" style="opacity: 0.99; ">
				<img id="img1" onerror="this.src='http://imgcache.qq.com/mediastyle/musicradio/img/cover.jpg';this.onerror=null;" style="opacity: 0.02; ">
				<b></b>
				<s></s>
			</div>
			-->
			<div class="song_name"><strong id="divsongname"></strong><span class="time" id="divsongtime"></span></div>
			
			<div class="song_bar"><div class="slider" style="width: 0%; " id="divsongbar"></div></div>
			
			<div class="song_volume" onmouseover="document.getElementById('spanvolumebar').className='volume_bar';" onmouseout="document.getElementById('spanvolumebar').className='volume_bar volume_bar_close';"><a class="btn_volume" href="javascript:;" hidefocus="hidefocus">音量</a><span id="spanvolumebar" class="volume_bar volume_bar_close" onmousedown="g_fmChn.mousedown();" onclick="g_fmChn.updateVol();" title="音量：75%"><span id="spanvolumeslider" class="slider" style="width: 75%; "></span></span></div>
			<div class="song_opt"><!-- r_onclick="g_fmChn.pauseFm();"-->
				<p>
				<a class="btn_pause" id="btnpause" href="javascript:;" hidefocus="hidefocus" title="播放">播放</a>
				<a class="btn_next" id="btnnext" href="javascript:;" name="script_btn" title="下一首" hidefocus="hidefocus">下一首</a>
				<!--
				<a class="btn_like" id="btnlike" href="javascript:;" title="喜欢" hidefocus="hidefocus">喜欢</a>
				<a class="btn_del" href="javascript:;" name="script_btn" title="不再播放" hidefocus="hidefocus">不再播放</a>
				
				
				<span><a class="btn_share" href="javascript:;" name="script_btn" title="分享" hidefocus="hidefocus">分享</a><a class="btn_lrc" href="javascript:;" name="script_btn" title="歌词" hidefocus="hidefocus">歌词</a></span>
				
				-->
				</p>
				<b></b>
			</div>
		</div>
		<script type="text/javascript" src="jquery.min.js"></script>
		<script type="text/javascript">
		var bg = chrome.extension.getBackgroundPage();
		var isPause = bg.isPause;
		
		function trackButton(button_id) {
			bg._gaq.push(['_trackEvent', button_id, 'clicked']);
		};
		
		$("#btnnext").click(function(){
			isPause = false;
			bg.isPause = false;
			bg.firstPause = false;
			$("#btnpause").removeClass("btn_play").addClass("btn_pause");
			
			
			trackButton('btn_next');
			bg.proxy.start();
			
			setTimeout(updateSongInfo, 1000);
		});
		
		$("#btnpause").click(function(){
			
			if(!isPause) {
				trackButton('btn_pause');
				// pause
				isPause = true;
				bg.isPause = true;
				$("#btnpause").removeClass("btn_pause").addClass("btn_play");
				bg.g_webPlayer.pausePlayer();
			}
			else {
				trackButton('btn_play');
				// play
				isPause = false;
				bg.isPause = false;
				$("#btnpause").removeClass("btn_play").addClass("btn_pause");
				if(bg.firstPause) {
					
					bg.firstPause = false;
					bg.proxy.start();
			
					setTimeout(updateSongInfo, 1000);
				}
				else {
					bg.g_webPlayer.startPlayer();
				}
				
			}
		});
		
		
		function updateSongInfo() {
			var songInfo = bg.g_webPlayer.getSongInfoObj();
			$("#divsongname").get(0).innerHTML = songInfo.msong + ' - ' + songInfo.msinger;
			$("#divsongbar").get(0).style.width = '0%';
			bg.g_webPlayer.OnSongPlaying = updateSongBar;
		}
		
		function updateSongBar(curtime, totaltime) {
			function formatTime(seconds) {
				var mins = parseInt(seconds / 60, 10),
					secs = parseInt(seconds % 60, 10);
				return mins + ":" + (secs > 9 ? "" : "0") + secs;
			}
			
			$("#divsongtime").get(0).innerHTML = '-' + formatTime(totaltime - curtime);
			$("#divsongbar").get(0).style.width = parseInt(curtime * 100 / totaltime, 10) + '%';
		}
		
		
		
		var song_info = "";
		$(document).ready(function(){
			updateSongInfo();
			
			bg.g_webPlayer.OnSongPlaying = updateSongBar;
			
			if(isPause) {
				$("#btnpause").removeClass("btn_pause").addClass("btn_play");
				
			}
			else {
				$("#btnpause").removeClass("btn_play").addClass("btn_pause");
			}
		});
		</script>
	</body>
</html>